node{
    stage("build"){
        bat "dotnet build --configuration Release"
    }
    stage("publish"){
        bat "dotnet publish -r win-x64 --self-contained"
    }
    stage("capture"){
        archiveArtifacts artifacts: '**/Release/net7.0/**'
    }
    stage("deploy"){
        bat '"C:\\Program Files\\IIS\\Microsoft Web Deploy V3\\msdeploy.exe" -verb:sync -source:contentPath=C:\\ProgramData\\Jenkins\\.jenkins\\workspace\\pipe\\WebApplication1\\bin\\Release\\net7.0 -dest:contentPath=C:\\inetpub\\wwwroot\\TestWebApp'
    }
}